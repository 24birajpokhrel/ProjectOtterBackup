/*
 * Project Otter — Definitive popup.css
 * Combined design system: Otter Branding + AccessiLens Dark System
 */

/* ─── Google Fonts fallback ──────────────────────────────────────────────── */
@import url('https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;500;600&family=DM+Mono:wght@400;500&display=swap');

/* ─── Design tokens ──────────────────────────────────────────────────────── */
:root {
  /* ProjectOtter brand colours */
  --brand-brown   : #614636;
  --brand-blue    : #176495;
  --brand-purple  : #7851A9;
  --brand-cream   : #F4EBE1;

  /* AccessiLens dark system */
  --clr-bg        : #0d0d10;
  --clr-surface   : #16161c;
  --clr-surface-2 : #1e1e26;
  --clr-border    : #262630;
  --clr-border-2  : #30303d;
  --clr-accent    : #f5c842;
  --clr-accent-dim: rgba(245,200,66,0.12);
  --clr-accent-glow: rgba(245,200,66,0.25);
  --clr-text      : #eae8e1;
  --clr-text-2    : #9a9890;
  --clr-text-muted: #55544f;
  --clr-warning-bg: rgba(251,191,36,0.08);
  --clr-warning-border: rgba(251,191,36,0.2);
  --clr-warning-text: #fbbf24;

  /* Spacing */
  --sp-1 : 4px;
  --sp-2 : 8px;
  --sp-3 : 12px;
  --sp-4 : 16px;

  /* Shape */
  --radius    : 10px;
  --radius-sm : 6px;
  --radius-xs : 4px;

  /* Fonts */
  --font-sans : 'DM Sans', -apple-system, BlinkMacSystemFont, sans-serif;
  --font-mono : 'DM Mono', 'Fira Code', monospace;

  /* Motion */
  --ease : cubic-bezier(.4,0,.2,1);
  --dur  : 150ms;
}

/* ─── Reset & Scrollbar ─────────────────────────────────────────────────── */
*, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

::selection {
  background: var(--clr-accent);
  color: var(--clr-bg);
}

::-webkit-scrollbar { width: 4px; }
::-webkit-scrollbar-track { background: var(--clr-bg); }
::-webkit-scrollbar-thumb { 
  background: var(--clr-border-2); 
  border-radius: 10px; 
}
::-webkit-scrollbar-thumb:hover { background: var(--clr-accent-muted); }

/* ─── Base ───────────────────────────────────────────────────────────────── */
body {
  width                  : 380px;
  background             : var(--brand-brown);
  color                  : var(--clr-text);
  font-family            : var(--font-sans);
  font-size              : 13px;
  line-height            : 1.5;
  -webkit-font-smoothing : antialiased;
  overflow-x             : hidden;
  user-select            : none;
}

/* ─── Header (ProjectOtter branding) ─────────────────────────────────────── */
.header {
  display         : flex;
  align-items     : center;
  justify-content : space-between;
  padding         : var(--sp-3) var(--sp-4);
}

.logo-area {
  display       : flex;
  align-items   : center;
  background    : var(--brand-blue);
  padding       : var(--sp-2) 20px var(--sp-2) var(--sp-2);
  border-radius : var(--radius);
  border        : 1px solid var(--brand-purple);
  flex-grow     : 1;
  margin-right  : var(--sp-3);
  gap           : var(--sp-3);
  box-shadow    : 0 4px 12px rgba(0,0,0,0.1);
}

.logo-circle {
  width           : 44px;
  height          : 44px;
  background      : var(--brand-cream);
  border-radius   : 50%;
  display         : flex;
  align-items     : center;
  justify-content : center;
  font-size       : 26px;
  flex-shrink     : 0;
}

.logo-text { display: flex; flex-direction: column; }

.logo-title {
  color          : #fff;
  font-size      : 16px;
  font-weight    : 600;
  line-height    : 1.2;
  letter-spacing : -0.2px;
}

.logo-sub {
  color     : rgba(255,255,255,0.6);
  font-size : 10px;
  font-family: var(--font-mono);
}

.header-meta {
  display     : flex;
  align-items : center;
}

.active-badge {
  font-family    : var(--font-mono);
  font-size      : 10px;
  color          : var(--clr-accent);
  letter-spacing : 0.05em;
  text-shadow    : 0 0 8px var(--clr-accent-glow);
  animation      : dot-pulse 2.4s var(--ease) infinite;
}
.active-badge.hidden { display: none; }

@keyframes dot-pulse {
  0%, 100% { opacity: 1; }
  50%       { opacity: 0.4; }
}

/* ─── Preview bar ────────────────────────────────────────────────────────── */
.preview-bar {
  height     : 3px;
  background : linear-gradient(90deg, var(--clr-accent), rgba(245,200,66,0.3));
  opacity    : 0;
  transition : opacity var(--dur) var(--ease);
}
.preview-bar.visible { opacity: 1; }

/* ─── Accordion ──────────────────────────────────────────────────────────── */
.accordion {
  padding        : var(--sp-2) var(--sp-3) var(--sp-3);
  display        : flex;
  flex-direction : column;
  gap            : var(--sp-2);
}

.accordion-item {
  background    : var(--clr-surface);
  border        : 1px solid var(--clr-border);
  border-radius : var(--radius);
  overflow      : hidden;
  transition    : border-color var(--dur) var(--ease), box-shadow var(--dur) var(--ease);
}

.accordion-item.has-active {
  border-color : var(--clr-accent);
  box-shadow   : inset 0 0 12px var(--clr-accent-dim);
}

/* ─── Accordion header ───────────────────────────────────────────────────── */
.accordion-header {
  width           : 100%;
  display         : flex;
  align-items     : center;
  justify-content : space-between;
  background      : none;
  border          : none;
  padding         : var(--sp-3) var(--sp-3);
  cursor          : pointer;
  color           : var(--clr-text);
  font-family     : var(--font-sans);
  text-align      : left;
  outline         : none;
}

.accordion-header:hover { background: rgba(255,255,255,0.02); }
.accordion-header:focus-visible { background: rgba(255,255,255,0.05); }

.accordion-header__left {
  display     : flex;
  align-items : center;
  gap         : var(--sp-3);
}

.accordion-icon {
  font-size   : 18px;
  width       : 26px;
  text-align  : center;
  flex-shrink : 0;
}

.accordion-label {
  display     : block;
  font-size   : 13px;
  font-weight : 600;
  color       : var(--clr-text);
  line-height : 1.2;
}

.accordion-desc {
  display   : block;
  font-size : 11px;
  color     : var(--clr-text-2);
  margin-top: 1px;
}

.chevron {
  width      : 16px;
  height     : 16px;
  color      : var(--clr-text-muted);
  flex-shrink: 0;
  transition : transform var(--dur) var(--ease);
}

.accordion-item.open .chevron {
  transform : rotate(180deg);
}

/* ─── Accordion content ──────────────────────────────────────────────────── */
.accordion-content {
  padding        : 0 var(--sp-3) var(--sp-3);
  display        : flex;
  flex-direction : column;
  gap            : var(--sp-2);
  border-top     : 1px solid var(--clr-border);
  padding-top    : var(--sp-2);
  background     : rgba(0,0,0,0.1);
  animation      : contentSlideIn 0.18s var(--ease);
}

.accordion-content.hidden { display: none; }

@keyframes contentSlideIn {
  from { opacity: 0; transform: translateY(-4px); }
  to   { opacity: 1; transform: translateY(0); }
}

/* ─── Feature card ───────────────────────────────────────────────────────── */
.feature-card {
  background    : var(--clr-surface-2);
  border        : 1px solid var(--clr-border);
  border-radius : var(--radius-sm);
  overflow      : hidden;
  transition    : border-color var(--dur) var(--ease), transform var(--dur) var(--ease);
}

.feature-card.active {
  border-color : var(--clr-accent);
  box-shadow   : 0 0 0 1px var(--clr-accent-dim);
}

.feature-card.teammate-zone {
  border-style : dashed;
  opacity      : 0.85;
}

.feature-card__header {
  display     : flex;
  align-items : center;
  gap         : var(--sp-2);
  padding     : var(--sp-2) var(--sp-3);
}

.feature-card__info { flex: 1; min-width: 0; }

.feature-card__name {
  display     : block;
  font-size   : 12px;
  font-weight : 600;
  color       : var(--clr-text);
}

.feature-card__desc {
  display   : block;
  font-size : 11px;
  color     : var(--clr-text-2);
  margin-top: 1px;
}

.feature-card__note {
  font-size  : 11px;
  color      : var(--clr-text-2);
  line-height: 1.6;
  padding    : var(--sp-1) var(--sp-3) var(--sp-2);
}

.feature-card__warning {
  font-size    : 11px;
  color        : var(--clr-warning-text);
  line-height  : 1.5;
  padding      : var(--sp-2) var(--sp-3);
  background   : var(--clr-warning-bg);
  border       : 1px solid var(--clr-warning-border);
  border-radius: var(--radius-xs);
  margin-top   : var(--sp-1);
}

/* ─── Feature card body ──────────────────────────────────────────────────── */
.feature-card__body {
  padding        : var(--sp-2) var(--sp-3) var(--sp-3);
  border-top     : 1px solid var(--clr-border);
  display        : flex;
  flex-direction : column;
  gap            : var(--sp-2);
}
.feature-card__body.hidden { display: none; }

/* ─── Teammate placeholder text ──────────────────────────────────────────── */
.teammate-placeholder {
  font-size  : 11px;
  color      : var(--clr-text-muted);
  font-style : italic;
  padding    : var(--sp-1) 0;
}

/* ─── Toggle switch ──────────────────────────────────────────────────────── */
.toggle {
  position    : relative;
  width       : 38px;
  height      : 21px;
  flex-shrink : 0;
  cursor      : pointer;
}

.toggle input { opacity: 0; width: 0; height: 0; position: absolute; }

.toggle__track {
  position      : absolute;
  inset         : 0;
  background    : var(--clr-border-2);
  border-radius : 21px;
  border        : 1px solid var(--clr-border-2);
  transition    : background var(--dur) var(--ease), border-color var(--dur) var(--ease);
}

.toggle__thumb {
  position      : absolute;
  top           : 3px;
  left          : 3px;
  width         : 13px;
  height        : 13px;
  background    : var(--clr-text-muted);
  border-radius : 50%;
  transition    : transform var(--dur) var(--ease), background var(--dur) var(--ease),
                  box-shadow var(--dur) var(--ease);
}

.toggle input:checked ~ .toggle__track {
  background   : var(--clr-accent-dim);
  border-color : var(--clr-accent);
}

.toggle input:checked ~ .toggle__thumb {
  transform  : translateX(17px);
  background : var(--clr-accent);
  box-shadow : 0 0 8px var(--clr-accent-glow);
}

.toggle input:focus-visible ~ .toggle__track {
  outline: 2px solid var(--clr-accent); outline-offset: 2px;
}

.toggle input:disabled ~ .toggle__track {
  opacity: 0.5;
  cursor: not-allowed;
}

/* ─── Setting row ────────────────────────────────────────────────────────── */
.setting-row { display: flex; flex-direction: column; gap: var(--sp-1); }

.setting-row__head {
  display: flex; justify-content: space-between; align-items: baseline;
}

.setting-row__label {
  font-size: 10px; font-weight: 600; color: var(--clr-text-2);
  text-transform: uppercase; letter-spacing: 0.08em;
}

.setting-row__value {
  font-family: var(--font-mono); font-size: 10px; color: var(--clr-accent);
  min-width: 36px; text-align: right;
}

/* ─── Slider ─────────────────────────────────────────────────────────────── */
input[type="range"] {
  -webkit-appearance: none; appearance: none;
  width: 100%; height: 3px;
  background: var(--clr-border-2); border-radius: 3px;
  outline: none; cursor: pointer; margin-top: var(--sp-1);
}

input[type="range"]::-webkit-slider-thumb {
  -webkit-appearance: none; appearance: none;
  width: 14px; height: 14px;
  background: var(--clr-accent); border-radius: 50%;
  cursor: pointer;
  transition: transform var(--dur) var(--ease), box-shadow var(--dur) var(--ease);
}

input[type="range"]:hover::-webkit-slider-thumb,
input[type="range"]:focus::-webkit-slider-thumb {
  transform: scale(1.2); box-shadow: 0 0 0 5px var(--clr-accent-glow);
}

input[type="range"]::-moz-range-thumb {
  width: 14px; height: 14px; border: none;
  background: var(--clr-accent); border-radius: 50%; cursor: pointer;
}

.slider-legend {
  display: flex; justify-content: space-between;
  font-size: 9px; color: var(--clr-text-muted); margin-top: 2px;
}

/* ─── Swatch grid ────────────────────────────────────────────────────────── */
.swatch-grid {
  display: flex; flex-wrap: wrap; gap: var(--sp-2); margin-top: var(--sp-2);
}

.swatch {
  width: 26px; height: 26px; border-radius: var(--radius-sm);
  border: 2px solid transparent; cursor: pointer; position: relative;
  padding: 0; flex-shrink: 0;
  transition: transform var(--dur) var(--ease), border-color var(--dur) var(--ease);
}
.swatch:hover { transform: scale(1.12); }
.swatch.selected { border-color: var(--clr-accent); box-shadow: 0 0 0 1px var(--clr-accent-glow); }
.swatch.selected::after {
  content: '✓'; position: absolute; inset: 0;
  display: flex; align-items: center; justify-content: center;
  font-size: 11px; font-weight: 700; color: rgba(0,0,0,0.65);
}

.swatch--custom {
  background: var(--clr-surface); border: 2px dashed var(--clr-border-2);
  display: flex; align-items: center; justify-content: center;
  font-size: 13px; color: var(--clr-text-muted); cursor: pointer;
  position: relative; overflow: hidden;
}
.swatch--custom:hover { border-color: var(--clr-accent); }
.swatch--custom input[type="color"] {
  position: absolute; inset: -4px; opacity: 0; cursor: pointer;
  width: calc(100% + 8px); height: calc(100% + 8px); border: none;
}

/* ─── Chips (CVD mode) ───────────────────────────────────────────────────── */
.chip-group-label {
  font-size: 10px; color: var(--clr-text-muted);
  margin-top: var(--sp-2); margin-bottom: var(--sp-1);
}

.chip-group { display: flex; gap: var(--sp-1); flex-wrap: wrap; }

.chip {
  padding: 4px 9px; border-radius: 20px;
  border: 1px solid var(--clr-border-2);
  background: var(--clr-surface); color: var(--clr-text-2);
  font-size: 11px; font-weight: 500; font-family: var(--font-sans);
  cursor: pointer; transition: all var(--dur) var(--ease); white-space: nowrap;
}
.chip:hover { border-color: var(--clr-accent); color: var(--clr-text); }
.chip.selected { background: var(--clr-accent); border-color: var(--clr-accent); color: #0d0d10; font-weight: 600; }
.chip__sub { font-size: 9px; opacity: 0.7; margin-left: 3px; }

/* ─── Keyboard hint ──────────────────────────────────────────────────────── */
.kbd-hint {
  display: flex; align-items: center; gap: var(--sp-1);
  font-size: 10px; color: var(--clr-text-muted); margin-top: var(--sp-1);
}
kbd {
  font-family: var(--font-mono); font-size: 9px; padding: 1px 5px;
  background: var(--clr-surface); border: 1px solid var(--clr-border-2);
  border-bottom: 2px solid var(--clr-border-2); border-radius: var(--radius-xs);
  color: var(--clr-text-2);
}

/* ─── Footer ─────────────────────────────────────────────────────────────── */
.footer {
  display: flex; align-items: center; justify-content: space-between;
  padding: var(--sp-2) var(--sp-3);
  background: var(--clr-surface); border-top: 1px solid var(--clr-border);
  gap: var(--sp-2);
}

.footer__status { display: flex; align-items: center; gap: var(--sp-1); flex: 1; min-width: 0; }

.footer__dot {
  width: 6px; height: 6px; border-radius: 50%;
  background: var(--clr-text-muted); flex-shrink: 0;
  transition: background var(--dur) var(--ease);
}
.footer__dot.active {
  background: var(--clr-accent);
  animation: dot-pulse 2.4s var(--ease) infinite;
}

.footer__text {
  font-family: var(--font-mono); font-size: 10px; color: var(--clr-text-muted);
  overflow: hidden; text-overflow: ellipsis; white-space: nowrap;
}

.footer__right { display: flex; align-items: center; gap: var(--sp-2); flex-shrink: 0; }

.footer__page {
  font-family: var(--font-mono); font-size: 9px; color: var(--clr-text-muted);
  max-width: 90px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;
}

.reset-btn {
  font-size: 10px; font-family: var(--font-sans); color: var(--clr-text-muted);
  background: none; border: 1px solid var(--clr-border);
  padding: 3px 8px; border-radius: var(--radius-sm); cursor: pointer;
  transition: all var(--dur) var(--ease);
}
.reset-btn:hover { border-color: #e05555; color: #e05555; }